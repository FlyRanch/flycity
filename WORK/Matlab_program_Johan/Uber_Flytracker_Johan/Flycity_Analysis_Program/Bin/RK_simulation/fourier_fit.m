function [ fourier_fit ] = fourier_fit( t, theta_L, eta_L, phi_L, theta_R, eta_R, phi_R )


    theta_L_f_fit = fit((t)',theta_L,'fourier8');
    eta_L_f_fit = fit((t)',eta_L,'fourier8');
    phi_L_f_fit = fit((t)',phi_L,'fourier8');
    theta_R_f_fit = fit((t)',theta_R,'fourier8');
    eta_R_f_fit = fit((t)',eta_R,'fourier8');
    phi_R_f_fit = fit((t)',phi_R,'fourier8');
    

    a_f_theta_L     = [ theta_L_f_fit.a0;...
                        theta_L_f_fit.a1; theta_L_f_fit.b1;...
                        theta_L_f_fit.a2; theta_L_f_fit.b2;...
                        theta_L_f_fit.a3; theta_L_f_fit.b3;...
                        theta_L_f_fit.a4; theta_L_f_fit.b4;...
                        theta_L_f_fit.a5; theta_L_f_fit.b5;...
                        theta_L_f_fit.a6; theta_L_f_fit.b6;...
                        theta_L_f_fit.a7; theta_L_f_fit.b7;...
                        theta_L_f_fit.a8; theta_L_f_fit.b8];
                    
    a_f_eta_L       = [ eta_L_f_fit.a0;...
                        eta_L_f_fit.a1; eta_L_f_fit.b1;...
                        eta_L_f_fit.a2; eta_L_f_fit.b2;...
                        eta_L_f_fit.a3; eta_L_f_fit.b3;...
                        eta_L_f_fit.a4; eta_L_f_fit.b4;...
                        eta_L_f_fit.a5; eta_L_f_fit.b5;...
                        eta_L_f_fit.a6; eta_L_f_fit.b6;...
                        eta_L_f_fit.a7; eta_L_f_fit.b7;...
                        eta_L_f_fit.a8; eta_L_f_fit.b8];
                    
    a_f_phi_L       = [ phi_L_f_fit.a0;...
                        phi_L_f_fit.a1; phi_L_f_fit.b1;...
                        phi_L_f_fit.a2; phi_L_f_fit.b2;...
                        phi_L_f_fit.a3; phi_L_f_fit.b3;...
                        phi_L_f_fit.a4; phi_L_f_fit.b4;...
                        phi_L_f_fit.a5; phi_L_f_fit.b5;...
                        phi_L_f_fit.a6; phi_L_f_fit.b6;...
                        phi_L_f_fit.a7; phi_L_f_fit.b7;...
                        phi_L_f_fit.a8; phi_L_f_fit.b8];

    a_f_theta_R     = [ theta_R_f_fit.a0;...
                        theta_R_f_fit.a1; theta_R_f_fit.b1;...
                        theta_R_f_fit.a2; theta_R_f_fit.b2;...
                        theta_R_f_fit.a3; theta_R_f_fit.b3;...
                        theta_R_f_fit.a4; theta_R_f_fit.b4;...
                        theta_R_f_fit.a5; theta_R_f_fit.b5;...
                        theta_R_f_fit.a6; theta_R_f_fit.b6;...
                        theta_R_f_fit.a7; theta_R_f_fit.b7;...
                        theta_R_f_fit.a8; theta_R_f_fit.b8];
                    
    a_f_eta_R       = [ eta_R_f_fit.a0;...
                        eta_R_f_fit.a1; eta_R_f_fit.b1;...
                        eta_R_f_fit.a2; eta_R_f_fit.b2;...
                        eta_R_f_fit.a3; eta_R_f_fit.b3;...
                        eta_R_f_fit.a4; eta_R_f_fit.b4;...
                        eta_R_f_fit.a5; eta_R_f_fit.b5;...
                        eta_R_f_fit.a6; eta_R_f_fit.b6;...
                        eta_R_f_fit.a7; eta_R_f_fit.b7;...
                        eta_R_f_fit.a8; eta_R_f_fit.b8];
                    
    a_f_phi_R       = [ phi_R_f_fit.a0;...
                        phi_R_f_fit.a1; phi_R_f_fit.b1;...
                        phi_R_f_fit.a2; phi_R_f_fit.b2;...
                        phi_R_f_fit.a3; phi_R_f_fit.b3;...
                        phi_R_f_fit.a4; phi_R_f_fit.b4;...
                        phi_R_f_fit.a5; phi_R_f_fit.b5;...
                        phi_R_f_fit.a6; phi_R_f_fit.b6;...
                        phi_R_f_fit.a7; phi_R_f_fit.b7;...
                        phi_R_f_fit.a8; phi_R_f_fit.b8];
                    
    n_theta_L       = theta_L_f_fit.w;
    n_eta_L         = eta_L_f_fit.w;
    n_phi_L         = phi_L_f_fit.w;
    
    n_theta_R       = theta_R_f_fit.w;
    n_eta_R         = eta_R_f_fit.w;
    n_phi_R         = phi_R_f_fit.w;
    
    Y = zeros(17,length(t),6);
    Y_dot = zeros(17,length(t),6);
    Y_ddot = zeros(17,length(t),6);
    
    for i = 1:6
        
        if i == 1
            n = n_theta_L;
        elseif i == 2
            n = n_eta_L;
        elseif i == 3
            n = n_phi_L;
        elseif i == 4
            n = n_theta_R;
        elseif i == 5
            n = n_eta_R;
        else
            n = n_phi_R;
        end
        

    
        Y(:,:,i) = [ones(1,length(t)); ...
                  cos(n*t); ...
                  sin(n*t); ...
                  cos(2*n*t); ...
                  sin(2*n*t); ...
                  cos(3*n*t); ...
                  sin(3*n*t); ...
                  cos(4*n*t); ...
                  sin(4*n*t); ...
                  cos(5*n*t); ...
                  sin(5*n*t); ...
                  cos(6*n*t); ...
                  sin(6*n*t); ...
                  cos(7*n*t); ...
                  sin(7*n*t); ...
                  cos(8*n*t); ...
                  sin(8*n*t)];

        Y_dot(:,:,i) = [ zeros(1,length(t)); ...
                      -n*sin(n*t); ...
                       n*cos(n*t); ...
                      -2*n*sin(2*n*t); ...
                       2*n*cos(2*n*t); ...
                      -3*n*sin(3*n*t); ...
                       3*n*cos(3*n*t); ...
                      -4*n*sin(4*n*t); ...
                       4*n*cos(4*n*t); ...
                      -5*n*sin(5*n*t); ...
                       5*n*cos(5*n*t); ...
                      -6*n*sin(6*n*t); ...
                       6*n*cos(6*n*t); ...
                      -7*n*sin(7*n*t); ...
                       7*n*cos(7*n*t); ...
                      -8*n*sin(8*n*t); ...
                       8*n*cos(8*n*t)];

        Y_ddot(:,:,i) = [ zeros(1,length(t)); ...
                       -n^2*cos(n*t); ...
                       -n^2*sin(n*t); ...
                       -4*n^2*cos(2*n*t); ...
                       -4*n^2*sin(2*n*t); ...
                       -9*n^2*cos(3*n*t); ...
                       -9*n^2*sin(3*n*t); ...
                       -16*n^2*cos(4*n*t); ...
                       -16*n^2*sin(4*n*t); ...
                       -25*n^2*cos(5*n*t); ...
                       -25*n^2*sin(5*n*t); ...
                       -36*n^2*cos(6*n*t); ...
                       -36*n^2*sin(6*n*t); ...
                       -49*n^2*cos(7*n*t); ...
                       -49*n^2*sin(7*n*t); ...
                       -64*n^2*cos(8*n*t); ...
                       -64*n^2*sin(8*n*t)];
           
    end
           
    theta_L_f   = Y(:,:,1)'*a_f_theta_L;
    eta_L_f     = Y(:,:,2)'*a_f_eta_L;
    phi_L_f     = Y(:,:,3)'*a_f_phi_L;
    
    theta_R_f   = Y(:,:,4)'*a_f_theta_R;
    eta_R_f     = Y(:,:,5)'*a_f_eta_R;
    phi_R_f     = Y(:,:,6)'*a_f_phi_R;
    
    theta_dot_L_f   = Y_dot(:,:,1)'*a_f_theta_L;
    eta_dot_L_f     = Y_dot(:,:,2)'*a_f_eta_L;
    phi_dot_L_f     = Y_dot(:,:,3)'*a_f_phi_L;
    
    theta_dot_R_f   = Y_dot(:,:,4)'*a_f_theta_R;
    eta_dot_R_f     = Y_dot(:,:,5)'*a_f_eta_R;
    phi_dot_R_f     = Y_dot(:,:,6)'*a_f_phi_R;
    
    theta_ddot_L_f   = Y_ddot(:,:,1)'*a_f_theta_L;
    eta_ddot_L_f     = Y_ddot(:,:,2)'*a_f_eta_L;
    phi_ddot_L_f     = Y_ddot(:,:,3)'*a_f_phi_L;
    
    theta_ddot_R_f   = Y_ddot(:,:,4)'*a_f_theta_R;
    eta_ddot_R_f     = Y_ddot(:,:,5)'*a_f_eta_R;
    phi_ddot_R_f     = Y_ddot(:,:,6)'*a_f_phi_R;
                    
%     figure()
%     plot(theta_L_f_fit,(t)',theta_L)
%     figure()
%     plot(eta_L_f_fit,(t)',eta_L)
%     figure()
%     plot(phi_L_f_fit,(t)',phi_L)
%     figure()
%     plot(theta_R_f_fit,(t)',theta_R)
%     figure()
%     plot(eta_R_f_fit,(t)',eta_R)
%     figure()
%     plot(phi_R_f_fit,(t)',phi_R)
    
%     
%         figure()
%     hold on
%     subplot(3,1,1); plot(t,theta_L,t,theta_L_f)
%     subplot(3,1,2); plot(t,eta_L,t,eta_L_f)
%     subplot(3,1,3); plot(t,phi_L,t,phi_L_f)
%     hold off
%     
%     figure()
%     hold on
%     subplot(3,1,1); plot(t,theta_R,t,theta_R_f)
%     subplot(3,1,2); plot(t,eta_R,t,eta_R_f)
%     subplot(3,1,3); plot(t,phi_R,t,phi_R_f)
%     hold off
%     
%     figure()
%     hold on
%     subplot(3,1,1); plot(t,theta_dot_L,t,theta_dot_L_f)
%     subplot(3,1,2); plot(t,eta_dot_L,t,eta_dot_L_f)
%     subplot(3,1,3); plot(t,phi_dot_L,t,phi_dot_L_f)
%     hold off
%     
%     figure()
%     hold on
%     subplot(3,1,1); plot(t,theta_dot_R,t,theta_dot_R_f)
%     subplot(3,1,2); plot(t,eta_dot_R,t,eta_dot_R_f)
%     subplot(3,1,3); plot(t,phi_dot_R,t,phi_dot_R_f)
%     hold off
%     
%     figure()
%     hold on
%     subplot(3,1,1); plot(t,theta_ddot_L,t,theta_ddot_L_f)
%     subplot(3,1,2); plot(t,eta_ddot_L,t,eta_ddot_L_f)
%     subplot(3,1,3); plot(t,phi_ddot_L,t,phi_ddot_L_f)
%     hold off
%     
%     figure()
%     hold on
%     subplot(3,1,1); plot(t,theta_ddot_R,t,theta_ddot_R_f)
%     subplot(3,1,2); plot(t,eta_ddot_R,t,eta_ddot_R_f)
%     subplot(3,1,3); plot(t,phi_ddot_R,t,phi_ddot_R_f)
%     hold off
    

    fourier_fit.theta_L         = theta_L_f;
    fourier_fit.eta_L           = eta_L_f;
    fourier_fit.phi_L           = phi_L_f;
    fourier_fit.theta_R         = theta_R_f;
    fourier_fit.eta_R           = eta_R_f;
    fourier_fit.phi_R           = phi_R_f;
    fourier_fit.theta_dot_L     = theta_dot_L_f;
    fourier_fit.eta_dot_L       = eta_dot_L_f;
    fourier_fit.phi_dot_L       = phi_dot_L_f;
    fourier_fit.theta_dot_R     = theta_dot_R_f;
    fourier_fit.eta_dot_R       = eta_dot_R_f;
    fourier_fit.phi_dot_R       = phi_dot_R_f;
    fourier_fit.theta_ddot_L    = theta_ddot_L_f;
    fourier_fit.eta_ddot_L      = eta_ddot_L_f;
    fourier_fit.phi_ddot_L      = phi_ddot_L_f;
    fourier_fit.theta_ddot_R    = theta_ddot_R_f;
    fourier_fit.eta_ddot_R      = eta_ddot_R_f;
    fourier_fit.phi_ddot_R      = phi_ddot_R_f;

end

